# WordPress single blog rules.
# Designed to be included in any server {} block.

# This order might seem weird - this is attempted to match last if rules below fail.
# http://wiki.nginx.org/HttpCoreModule
location / {
	try_files $uri $uri/ /index.php?$args;
	# Content Security Policy
	add_header Content-Security-Policy "default-src * ; script-src 'self' 'unsafe-inline' *.googleapis.com *.gstatic.com *.google.com *.jquery.com *.google-analytics.com *.twitter.com *.facebook.net *.fontdeck.com *.yahooapis.com; style-src 'self' 'unsafe-inline' *.googleapis.com *.bootstrapcdn.com; font-src 'self' data: *.gstatic.com *.bootstrapcdn.com *.fontdeck.com; img-src * data:;";
}

# Add trailing slash to */wp-admin requests.
rewrite /wp-admin$ $scheme://$host$uri/ permanent;

# Don't use Content Security Policy in WP admin
location /wp-admin {
	add_header Content-Security-Policy "";
}

# Uncomment one of the lines below for the appropriate caching plugin (if used).
#include global/wordpress-wp-super-cache.conf;
#include global/wordpress-w3-total-cache.conf;
